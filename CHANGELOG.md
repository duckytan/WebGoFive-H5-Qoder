# 更新日志

本文档记录H5五子棋游戏的所有重要变更。

---

## [1.0.1] - 2024-11-03

### ✨ 新增功能

#### 1. 最后落子高亮
- 为最后一次落子的棋子添加醒目的视觉标记
- 黑棋显示金黄色光晕，白棋显示粉红色光晕
- 包含发光外圈、内圈光晕和中心脉冲点的多层视觉效果
- 帮助玩家快速识别当前落子位置

#### 2. 全新AI算法系统
重新构建了四个难度等级的AI算法，各难度有明显差异：

- **新手级别 (BEGINNER)**
  - 50%几率能找到获胜落点
  - 40%几率阻止对手获胜
  - 其余时间在中心区域随机落子
  - 适合初学者建立信心

- **正常级别 (NORMAL)**
  - 必定找到获胜/阻止对手获胜的落点
  - 使用基于评分系统的策略
  - 评估所有候选位置，选择得分最高的
  - 考虑棋型（五连、活四、冲四、活三等）
  - 加入组合棋型的额外分数
  - 适合有一定经验的玩家

- **困难级别 (HARD)**
  - 在正常级别基础上增加Minimax搜索算法
  - 搜索深度2层，能预测2步棋
  - 评估多个候选落子的未来走势
  - 选择最大化自己优势的落子
  - 适合高手玩家

- **地狱级别 (HELL)**
  - 使用Alpha-Beta剪枝的深度搜索
  - 搜索深度3层，能预测3步棋
  - 剪枝优化大幅提升搜索效率
  - 评估更深的博弈树
  - 接近专家级AI水平
  - 对专家级玩家也有优势

**AI算法技术细节：**
- 实现了完整的棋型识别系统（五连、活四、冲四、破四、活三、冲三、活二等）
- 智能候选位置生成（在已有棋子周围搜索）
- 位置权重评估（中心区域更有价值）
- 进攻与防守权重平衡
- 组合棋型加分机制（双活四、双活三、活四+活三等）
- Minimax博弈树搜索
- Alpha-Beta剪枝优化

#### 3. 版本号显示
- 在页面标题栏添加了版本号徽章（v1.0.1）
- 采用半透明玻璃质感设计
- 带发光效果，与界面风格统一
- 方便开发者和用户确认当前版本

### 🔧 技术改进

- 在 `GomokuGame` 类中新增 `getLastMove()` 方法用于获取最后一步落子
- 在 `SimpleBoardRenderer` 类的 `drawPiece()` 方法中新增 `isLastMove` 参数
- 新增大量AI辅助方法：
  - `evaluateAllMoves()` - 评估所有候选位置
  - `getCandidateMoves()` - 智能生成候选位置
  - `evaluatePosition()` / `evaluateMoveValue()` - 位置评估
  - `calculateScore()` - 计算棋型分数
  - `analyzeLinePattern()` - 分析单向棋型
  - `checkLineSpace()` - 检查连线两端空位
  - `calculateComboBonus()` - 计算组合棋型加分
  - `minimaxSearch()` / `minimax()` - Minimax搜索
  - `alphaBetaSearch()` / `alphaBeta()` - Alpha-Beta剪枝搜索
  - `countNeighbors()` - 计算邻近棋子数
  - `getPositionalScore()` - 计算位置分数
  - `isForbiddenMoveForPlayer()` - 检查禁手
  - `findAnyValidMove()` - 查找任意有效位置

### 📊 数据结构优化

- 在构造函数中新增 `boardSize` 属性
- 新增 `aiDirections` 数组存储四个搜索方向
- 新增 `aiScoreTable` 对象，包含所有棋型的分值表

### 🎨 样式更新

- 新增 `.version-badge` 样式类，实现版本号徽章的视觉效果

---

## [1.0.0] - 2024-11-01

### 初始版本
- 基础的双人对战功能
- 基础的人机对战功能
- 禁手规则实现
- 游戏回放功能
- 游戏保存/加载功能
- 响应式界面设计

---

## 版本号说明

版本号格式：`主版本号.次版本号.修订号`

- **主版本号**：重大功能更新或架构变更
- **次版本号**：新功能添加
- **修订号**：Bug修复和小优化
