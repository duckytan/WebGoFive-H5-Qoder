# 00 快速开始指南

## 文档目的

5分钟快速了解H5五子棋项目的核心概念、技术栈和文件结构，为深入阅读其他文档打下基础。

---

## 项目一句话描述

**纯前端、零依赖、完全离线运行的HTML5五子棋游戏，支持4种模式、4级AI、完整禁手规则和VCF练习系统。**

---

## 核心特性速览

### 游戏功能
- ✅ **完整五子棋规则**：五连获胜、禁手检测（三三、四四、长连）
- ✅ **4种游戏模式**：
  - PvP (Player vs Player) - 双人对战
  - PvE (Player vs Engine) - 人机对战
  - EvE (Engine vs Engine) - 机机对战
  - VCF练习 - 冲四战术专题训练
- ✅ **4级AI难度**：新手(25%胜率)、正常(50%)、困难(75%)、地狱(90%)
- ✅ **VCF练习系统**：40道经典题目，4个难度级别，自动进度追踪

### 辅助功能
- ✅ 游戏保存/加载/回放
- ✅ 悔棋、提示、新游戏
- ✅ 自动保存、设置持久化
- ✅ 响应式UI、木质主题
- ✅ 完全离线运行、零外部依赖

---

## 技术栈

| 技术 | 版本/说明 | 用途 |
|------|-----------|------|
| HTML5 | 语义化标签 | 页面结构（唯一HTML文件） |
| CSS3 | CSS变量、Flexbox、Grid | 响应式布局和主题样式 |
| JavaScript | ES6+ (Class, Arrow, Async) | 所有业务逻辑 |
| Canvas 2D | HTML5 Canvas API | 棋盘和棋子渲染 |
| LocalStorage | Web Storage API | 进度、设置、自动存档 |

**关键技术决策**：
- **无框架**：零依赖，完全可控
- **无构建工具**：直接浏览器运行，无需编译
- **模块化**：Window全局对象导出，类ES Module风格
- **OOP设计**：ES6 Class，清晰的职责分离

---

## 项目结构

```
project/
├── index.html                 # 唯一HTML文件（663行）
│                              # 包含所有UI结构和弹窗
│
├── js/                        # JavaScript核心模块（8个文件）
│   ├── game-core.js          # 游戏核心引擎（2145行）★★★
│   │                         # - GomokuGame类：状态管理、规则判定
│   │                         # - AI算法：4级难度、Alpha-Beta剪枝
│   │                         # - 禁手检测：三三、四四、长连
│   │                         # - 导出：window.GomokuGame
│   │
│   ├── board-renderer.js     # Canvas渲染器（723行）★★★
│   │                         # - SimpleBoardRenderer类：棋盘绘制
│   │                         # - 事件处理：点击、悬停、高亮
│   │                         # - 导出：window.SimpleBoardRenderer
│   │
│   ├── demo.js               # UI交互主控（1775行）★★★
│   │                         # - InterfaceDemo类：UI协调器
│   │                         # - 模式切换、按钮事件、状态同步
│   │                         # - 导出：window.demo（实例）
│   │
│   ├── vcf-practice.js       # VCF练习管理（847行）★★
│   │                         # - VCFPracticeManager类：题库管理
│   │                         # - 40道经典VCF题，AI地狱难度防守
│   │                         # - 导出：window.VCFPracticeManager
│   │
│   ├── ai-advanced.js        # 深度搜索AI（692行）★★
│   │                         # - AdvancedAI类：高级AI算法
│   │                         # - 开局库、威胁序列、VCF搜索
│   │                         # - 导出：window.AdvancedAI
│   │
│   ├── game-save-load.js     # 存档系统（626行）★
│   │                         # - GameSaveLoad类：保存/加载
│   │                         # - 自动保存、文件导入导出
│   │                         # - 导出：window.GameSaveLoad
│   │
│   ├── game-replay.js        # 回放系统（约500行）★
│   │                         # - GameReplay类：棋局回放
│   │                         # - 播放控制、进度条、速度调节
│   │                         # - 导出：window.GameReplay
│   │
│   └── utils.js              # 工具函数库（302行）
│                             # - GameUtils对象：通用工具
│                             # - 格式化、存储、下载等
│                             # - 导出：window.GameUtils
│
├── css/                       # 样式文件（2个文件）
│   ├── style.css             # 主样式（1281行）
│   │                         # - CSS变量、木质主题
│   │                         # - Grid布局、响应式设计
│   │
│   └── animations.css        # 动画效果（约200行）
│                             # - 过渡动画、加载动画
│
└── test-module-api.html       # 模块API测试页面（可选）
```

---

## 核心模块关系图

```
┌─────────────────────────────────────────────────────────┐
│                      index.html                         │
│  (UI结构、模态框、按钮、Canvas容器)                       │
└────────────────────┬────────────────────────────────────┘
                     │ 加载JS模块（按顺序）
          ┌──────────┴──────────┐
          ↓                     ↓
   ┌──────────────┐      ┌──────────────┐
   │  utils.js    │      │其他依赖模块   │
   │ (GameUtils)  │      │              │
   └──────────────┘      └──────────────┘
          ↓                     ↓
   ┌──────────────────────────────────────┐
   │         game-core.js                 │★★★
   │        (GomokuGame)                  │
   │  - board: 15x15棋盘状态              │
   │  - rules: 规则判定、禁手检测         │
   │  - ai: 4级AI算法                    │
   └───────────┬──────────────────────────┘
               │ 使用
   ┌───────────┴───────────┐
   │   ai-advanced.js      │★★
   │   (AdvancedAI)        │
   │  - 开局库、VCF搜索     │
   └───────────────────────┘
               │
          ┌────┴────┐
          ↓         ↓
┌─────────────────┐ ┌─────────────────┐
│board-renderer.js│ │ vcf-practice.js │
│(BoardRenderer)  │ │(VCFPracticeMan) │
│ - Canvas渲染    │ │ - 40道VCF题库   │
│ - 事件处理      │ │ - 进度追踪      │
└────┬────────────┘ └────┬────────────┘
     │                   │
     └────────┬──────────┘
              ↓
   ┌──────────────────────┐
   │      demo.js         │★★★
   │  (InterfaceDemo)     │
   │  - UI主控制器        │
   │  - 协调所有模块      │
   │  - 事件分发          │
   └───────┬──────────────┘
           │
   ┌───────┴───────┐
   ↓               ↓
┌──────────────┐ ┌──────────────┐
│save-load.js  │ │ replay.js    │
│(GameSaveLoad)│ │ (GameReplay) │
│ - 保存加载   │ │ - 回放控制   │
└──────────────┘ └──────────────┘
```

**加载顺序（index.html中的script标签顺序）**：
```javascript
1. utils.js           // 工具函数，无依赖
2. ai-advanced.js     // AI算法，依赖utils（可选）
3. game-core.js       // 游戏核心，依赖utils和ai-advanced
4. board-renderer.js  // 渲染器，依赖game-core
5. vcf-practice.js    // VCF管理器，依赖game-core
6. game-save-load.js  // 存档，依赖game-core和utils
7. game-replay.js     // 回放，依赖game-core和utils
8. demo.js            // UI主控，依赖所有模块
```

---

## 数据流图

### 1. 玩家落子流程
```
用户点击Canvas
      ↓
SimpleBoardRenderer.placePiece(x, y)
      ↓
[判断] 是VCF模式? → YES → demo.handleVCFPracticeMove(x, y)
      ↓ NO
demo.canPlacePiece() [权限检查]
      ↓
GomokuGame.placePiece(x, y)
      ↓
[验证] 位置有效? 不是禁手? 游戏未结束?
      ↓
[更新] board[y][x] = currentPlayer
      ↓
[判定] checkWin() 或 checkForbidden()
      ↓
[切换] currentPlayer = 1 ↔ 2
      ↓
SimpleBoardRenderer.render() [重绘]
      ↓
demo.handleMoveResult() [UI更新]
      ↓
[AI模式] → scheduleAIMove()
```

### 2. AI思考流程
```
GomokuGame.scheduleAIMove()
      ↓
[延迟] AI思考时间（500-1800ms根据难度）
      ↓
GomokuGame.getAIMove(difficulty)
      ↓
[判断难度]
  - BEGINNER: getAIMoveSimple() [随机+简单评分]
  - NORMAL: getAIMoveNormal() [Alpha-Beta深度2-4]
  - HARD: getAIMoveHard() [深度搜索+威胁分析]
  - HELL: getAIMoveHell() [VCF+完整威胁空间]
      ↓
[返回] {x, y}
      ↓
GomokuGame.placePiece(x, y)
      ↓
[同玩家落子流程]
```

### 3. 游戏保存/加载流程
```
保存流程：
  demo → GameSaveLoad.saveGame()
      → game.exportData() [导出棋盘、历史、状态]
      → JSON.stringify()
      → downloadAsJSON() [浏览器下载]

加载流程：
  用户选择文件 → GameSaveLoad.handleFileLoad()
      → FileReader.readAsText()
      → JSON.parse()
      → validateGameData() [验证格式]
      → game.loadFromData() [恢复状态]
      → boardRenderer.render() [重绘]
      → demo.restoreUI() [UI同步]
```

---

## 关键类和方法速览

### GomokuGame (game-core.js)
```javascript
class GomokuGame {
    constructor()                    // 初始化棋盘、状态
    placePiece(x, y)                // 落子主方法
    checkWin(x, y)                  // 五连判定
    checkForbidden(x, y)            // 禁手检测
    getAIMove(difficulty)           // AI落子入口
    undoMove()                      // 悔棋
    reset()                         // 重置游戏
    exportData()                    // 导出数据
    loadFromData(data)              // 加载数据
}
```

### SimpleBoardRenderer (board-renderer.js)
```javascript
class SimpleBoardRenderer {
    constructor(canvasId)           // 初始化Canvas
    render()                        // 绘制棋盘
    placePiece(x, y)                // 处理点击落子
    highlightHintPosition(x, y)     // 提示高亮
    highlightForbiddenPosition()    // 禁手高亮
    drawPiece(x, y, player)         // 绘制单个棋子
}
```

### InterfaceDemo (demo.js)
```javascript
class InterfaceDemo {
    constructor()                   // 初始化UI和事件
    startNewGame()                  // 新游戏
    toggleGameMode()                // 切换模式
    handleMoveResult(result)        // 处理落子结果
    showGameResult(result)          // 显示游戏结果
    handleVCFPracticeMove(x, y)     // VCF练习落子
    updateGameStatus()              // 更新状态显示
}
```

---

## 运行项目

### 方式1：本地HTTP服务器（推荐）
```bash
# Python 3
cd project
python3 -m http.server 8080

# Node.js
npx http-server -p 8080

# 访问 http://localhost:8080
```

### 方式2：VS Code Live Server
1. 安装 VS Code 扩展 "Live Server"
2. 右键 `index.html` → "Open with Live Server"
3. 自动打开浏览器

### 方式3：直接打开（部分功能受限）
```bash
# 直接在浏览器打开 file:///path/to/index.html
# 注意：某些浏览器会限制 file:// 协议的 LocalStorage
```

---

## 浏览器兼容性

| 浏览器 | 最低版本 | 测试状态 |
|--------|----------|----------|
| Chrome | 60+ | ✅ 完全支持 |
| Firefox | 55+ | ✅ 完全支持 |
| Safari | 12+ | ✅ 完全支持 |
| Edge | 79+ | ✅ 完全支持 |
| Mobile Safari | 11+ | ✅ 支持（触摸优化） |
| Chrome Android | 60+ | ✅ 支持 |

**关键API要求**：
- Canvas 2D Context
- ES6 Class / Arrow Functions
- LocalStorage
- FileReader API (用于文件加载)

---

## 核心概念

### 1. 模块导出机制
```javascript
// 所有模块都使用此模式导出
class MyModule {
    // 类实现
}

// 浏览器环境导出
if (typeof window !== 'undefined') {
    window.MyModule = MyModule;
}
```

### 2. 坐标系统
```javascript
// 棋盘坐标：左上角(0,0)，右下角(14,14)
// x: 横向（0-14）
// y: 纵向（0-14）
// board[y][x] = 0（空） | 1（黑） | 2（白）
```

### 3. 游戏状态
```javascript
gameStatus = 'ready' | 'playing' | 'finished'
currentPlayer = 1（黑棋先手） | 2（白棋后手）
winner = null | 0（平局） | 1（黑胜） | 2（白胜）
```

### 4. 禁手规则（仅黑棋）
- **三三禁手**：一步形成2个活三
- **四四禁手**：一步形成2个四（活四/冲四）
- **长连禁手**：一步形成6子及以上
- **五连优先**：五连获胜不受禁手限制

---

## 下一步

1. **快速了解需求**：阅读 `01_项目需求规格说明书.md`
2. **理解架构**：阅读 `02_技术架构设计文档.md`
3. **深入算法**：阅读 `03_游戏规则与AI算法要点.md`
4. **学习UI规范**：阅读 `04_UI设计与交互规范.md`
5. **开始开发**：参考 `05_重新开发任务规划清单.md`

---

## 常见问题

### Q1: 为什么不使用npm包管理?
**A**: 保持项目简单、零依赖、完全离线可用，降低复杂度。

### Q2: Canvas性能如何?
**A**: 15×15棋盘仅225个交叉点，Canvas 2D完全够用，保持60fps无压力。

### Q3: AI算法强度如何?
**A**: 地狱难度采用VCF搜索+威胁空间分析，对普通玩家有90%胜率。

### Q4: 移动端体验如何?
**A**: 响应式设计，支持触摸操作，但建议屏幕≥768px以获得最佳体验。

### Q5: 可以在线对战吗?
**A**: 当前版本不支持，所有功能都是本地单机。可扩展WebSocket实现联机。

---

**文档版本**: v1.0  
**最后更新**: 2025-01  
**下一篇**: [01_项目需求规格说明书.md](./01_项目需求规格说明书.md)
