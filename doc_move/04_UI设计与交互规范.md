# 04 - UI设计与交互规范

> **目的**: 规范H5五子棋的界面布局、视觉风格、交互行为，确保AI复刻时保持一致体验

---

## 1. 设计语言

### 1.1 核心风格
- **主题**: 复古木质 + 现代UI
- **色彩**: 暖色调为主，辅以蓝/绿色状态色
- **材质**: 木纹背景、棋子光泽、柔和阴影
- **字体**: `Segoe UI`, `Tahoma`, `sans-serif`

### 1.2 配色系统 (CSS变量)

```css
:root {
  --board-wood-light: #f4e4bc;
  --board-wood-medium: #d4a574;
  --board-wood-dark: #8b4513;
  --board-line-color: #654321;

  --piece-black: #1a1a1a;
  --piece-white: #f8f8f8;

  --primary-color: #8b4513;
  --secondary-color: #d4a574;
  --accent-color: #f4e4bc;

  --success-color: #4caf50;
  --warning-color: #ff9800;
  --error-color:   #f44336;
  --info-color:    #2196f3;

  --border-radius: 8px;
  --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
}
```

### 1.3 字体与排版
- 标题 (H1): 28-32px, 加粗, 暖色
- 副标题 (H2/H3): 20-24px, 加粗, 下划线
- 正文: 14-16px, `line-height: 1.6`
- 数值/状态: 等宽或半等宽字体

---

## 2. 页面布局

### 2.1 主布局
```
┌──────────────────────────────┐
│         Header (标题栏)       │
├─────────────┬───────────────┤
│  左侧面板    │   棋盘+提示+回放 │
│  (320px)     │   (自适应)       │
└─────────────┴───────────────┘
```

- 使用CSS Grid: `grid-template-columns: 300px 1fr`
- Gap: `--spacing-xl` (约32px)
- 响应式：≤1024px时改为纵向排列，棋盘居中

### 2.2 区块划分
| 区块 | 内容 |
|------|------|
| Header | Logo/标题/版本/全局按钮 |
| 左侧面板 | 当前玩家、状态信息、控制区、AI设置、VCF面板 |
| 棋盘区域 | Canvas棋盘、坐标、提示条、回放控制器 |
| 模态框 | 设置、帮助、结果、回放等 |

---

## 3. Header设计

| 元素 | 规范 |
|------|------|
| 标题 | `H5五子棋` + emoji (🏁) + 版本徽章 |
| 版本徽章 | 圆角胶囊，白色半透明，字体0.85rem |
| 控制按钮 | Icon Button，尺寸44x44px，圆角50%，背景半透明 |
| 按钮内容 | `💡` (提示), `⚙️` (设置), `❓` (帮助) |

```html
<header class="game-header">
  <div class="header-content">
    <h1 class="game-title">
      <span class="title-icon">🏁</span>
      H5五子棋
      <span class="version-badge">v1.2.0</span>
    </h1>
    <div class="header-controls">
      <button class="btn btn--icon" id="hint-btn">💡</button>
      ...
    </div>
  </div>
</header>
```

---

## 4. 左侧面板

### 4.1 当前玩家
- 卡片式背景
- 包含棋子图标 (40px) + 文本
- 黑棋/白棋通过切换`piece--black`/`piece--white`

```html
<div class="player-info">
  <h3 class="section-title">当前玩家</h3>
  <div class="current-player" id="current-player">
    <div class="player-indicator">
      <div class="piece piece--black" id="player-piece"></div>
      <span class="player-name" id="player-name">黑棋先手</span>
    </div>
  </div>
</div>
```

### 4.2 状态信息
- 列表形式，每项包含标签+值
- 值使用主色，字体加粗

| 字段 | 示例 |
|------|------|
| 模式 | 人机对战 (正常) |
| 回合 | 第12回合 |
| 用时 | 05:34 |

### 4.3 控制按钮组
- 主按钮 (新游戏): `btn--primary` (深色背景)
- 次按钮 (悔棋/模式切换/保存/加载/回放): `btn--secondary`
- 按钮含图标+文本
- 状态禁止(`disabled`)时降低透明度

### 4.4 AI设置面板
- 仅在`gameMode`为PvE或EvE时显示
- PvE: 单个难度选择器
- EvE: 黑/白双方各一个选择器
- AI思考指示器包含点点点动画

### 4.5 VCF练习面板
- 仅在VCF模式显示
- 包含标题/难度/描述/提示/进度/操作按钮
- 不同难度使用不同渐变背景

颜色建议：
- 入门: `#c8e6c9 → #a5d6a7`
- 初级: `#fff9c4 → #fff59d`
- 中级: `#ffe0b2 → #ffcc80`
- 高级: `#ffccbc → #ffab91`

---

## 5. 棋盘区域

### 5.1 Canvas容器
- 宽高默认600px (可调)
- 外围添加光影效果，模拟实体棋盘
- 预留坐标标记层 (隐藏/显示)

### 5.2 棋盘绘制规范
- 边距: 30px
- 格子尺寸: 36px
- 网格线颜色: `var(--board-line-color)`
- 网格线宽度: 1.5px
- 星位: (3,3), (3,11), (7,7), (11,3), (11,11)
- 星位半径: 4px

### 5.3 棋子绘制
```javascript
drawPiece(x, y, player) {
  const gradient = ctx.createRadialGradient(cx - 5, cy - 5, 5, cx, cy, 20);
  if (player === 1) { // 黑
    gradient.addColorStop(0, '#666');
    gradient.addColorStop(1, '#111');
  } else {
    gradient.addColorStop(0, '#fff');
    gradient.addColorStop(1, '#ccc');
  }
  ctx.fillStyle = gradient;
  ctx.beginPath();
  ctx.arc(cx, cy, 14, 0, Math.PI * 2);
  ctx.fill();
}
```

### 5.4 高亮效果
- 悬停: 半透明圆 (alpha=0.2)
- 最近落子: 外圈高亮 (白色或深色)
- 禁手: 红色圆环 + 文本
- AI提示: 蓝色闪烁圈 (5秒自动消失)

### 5.5 提示条
- 位于棋盘下方
- `ARIA role="status"` + `aria-live="polite"`
- 各种状态使用不同颜色

### 5.6 回放控制器
- 模拟音乐播放器布局
- 组件: 标题、步数、进度条、时间、主控按钮、速度按钮、功能按钮
- 进度条支持拖动 (`input type="range"` + 自定义样式)

---

## 6. 模态框规范

### 6.1 通用结构
```html
<div class="modal" id="settings-modal" role="dialog" aria-modal="true">
  <div class="modal-content">
    <header class="modal-header">
      <h2>设置</h2>
      <button class="modal-close" aria-label="关闭">×</button>
    </header>
    <div class="modal-body">
      <!-- 内容 -->
    </div>
    <footer class="modal-footer">
      <button class="btn btn--secondary">取消</button>
      <button class="btn btn--primary">保存</button>
    </footer>
  </div>
</div>
```

### 6.2 设置模态内容
- 切换开关（自定义样式）
- 选项: 显示坐标/风险提示/音效/动画/自动保存
- 采用表单元素+描述

### 6.3 帮助模态内容
- 章节: 基本规则、禁手说明、快捷键、VCF介绍
- 图示: 使用ASCII或SVG展示活三/禁手
- 支持滚动 (`max-height: 70vh`)

### 6.4 游戏结果模态
- 内容: 获胜方/用时/步数
- 按钮: 再来一局/关闭/保存棋局
- 背景: 根据胜负不同呈现不同颜色

---

## 7. 交互细节

### 7.1 按钮状态
- Hover: 背景变亮、提高阴影
- Active: 压低阴影
- Disabled: 50%透明、禁用点击

### 7.2 快捷键
```
Ctrl/Cmd + N → 新游戏
Ctrl/Cmd + Z → 悔棋
M             → 模式切换
H             → AI提示
Esc           → 关闭模态
```

### 7.3 提示系统
- 默认提示: "点击棋盘开始游戏"
- 信息提示: 蓝色
- 警告提示: 橙色
- 错误提示: 红色
- 成功提示: 绿色
- 每条提示3秒后淡出（或保持，视情况）

### 7.4 AI思考状态
- 禁用相关按钮 (悔棋/保存等)
- 显示动画 `AI思考中 ...`
- 允许取消（可选）

### 7.5 VCF模式交互
- 禁用悔棋/存档/回放按钮
- 落子错误提示正确位置（友好）
- 完成后显示庆祝动画 (可使用CSS动画)

---

## 8. 响应式设计

### 8.1 断点
- ≥1200px: 全尺寸桌面布局
- 768~1199px: 缩小边距，棋盘占比增大
- <768px: 单列布局

### 8.2 移动端优化
- 按钮高度 ≥ 44px
- 文字大小 ≥ 14px
- 触摸反馈 (active状态)
- 允许拖动棋盘（可选）

### 8.3 Retina支持
- Canvas按devicePixelRatio放大
- CSS尺寸与实际像素区分

```javascript
const dpr = window.devicePixelRatio || 1;
canvas.width  = canvasWidth * dpr;
canvas.height = canvasHeight * dpr;
ctx.scale(dpr, dpr);
```

---

## 9. 动画与动效

### 9.1 棋子落子动画
- 缩放 + 轻微弹跳
- 可使用CSS `@keyframes piece-drop`

### 9.2 胜利连线
- 渐变线条，从起点动画到终点
- 闪烁效果表示胜利

### 9.3 VCF完成动画
- 面板背景闪烁或浮动粒子
- 显示"挑战成功"徽章

### 9.4 模态框
- 淡入淡出 + scale动画
- 遮罩层半透明黑色

---

## 10. 可访问性 (A11y)

- 为Canvas添加`aria-label="五子棋棋盘 - 15x15网格"`
- 提示信息使用`role="status"` + `aria-live="polite"`
- 按钮提供`aria-label`和`title`
- 模态框使用`role="dialog"` + `aria-modal="true"`
- 支持键盘导航（Tab顺序、Enter触发）

---

## 11. 资源引用
- 无外部字体/图标，统一使用Emoji
- 若需额外图标，可使用SVG内嵌
- 尽量减少静态资源，保持纯前端

---

**开发提示**
- 使用CSS变量控制主题，可轻松切换
theme
- 保持class命名一致 (`BEM`风格)
- 将所有交互逻辑放在demo.js，样式控制在CSS

---

**下一步**: 按照[05_重新开发任务规划清单](./05_重新开发任务规划清单.md)逐步实现界面
