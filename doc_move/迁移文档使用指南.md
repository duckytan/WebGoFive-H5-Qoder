# 迁移文档使用指南

> **目标读者**: AI开发助手  
> **目的**: 指导如何高效使用这套迁移文档完整复刻H5五子棋项目

---

## 📖 快速开始（3步走）

### 第1步：理解项目（30分钟）

**必读文档**：
1. `README.md` - 获取全局视图
2. `00_快速开始指南.md` - 了解项目结构
3. `01_项目需求规格说明书.md` - 明确功能范围

**检查点**：
- [ ] 知道项目有哪些功能模块
- [ ] 理解技术栈（纯JS，无构建工具）
- [ ] 了解模块导出方式（window全局对象）

### 第2步：掌握核心逻辑（2小时）

**必读文档**：
1. `02_技术架构设计文档.md` - 理解模块关系
2. `03_游戏规则与AI算法要点.md` - 核心算法
3. `04_UI设计与交互规范.md` - 界面规范

**检查点**：
- [ ] 能画出模块依赖图
- [ ] 理解禁手检测算法
- [ ] 知道AI的4个难度级别
- [ ] 了解Canvas渲染流程

### 第3步：开始编码（持续）

**参考文档**：
1. `05_重新开发任务规划清单.md` - 开发步骤
2. `07_核心代码示例与模板.md` - 代码模板
3. `10_完整实现细节补充.md` - 细节查阅

**开发流程**：
```
阶段0: 环境准备 → 
阶段1: 核心功能（棋盘+落子+胜负） → 
阶段2: 禁手规则 → 
阶段3: AI系统 → 
阶段4: 存档回放 → 
阶段5: VCF练习 → 
阶段6: UX优化 → 
阶段7: 测试部署
```

---

## 🎯 按需查阅索引

### 场景1: 实现某个具体功能

| 功能 | 查阅文档 | 章节 |
|------|---------|------|
| 棋盘渲染 | 07-代码示例 + 10-细节补充 | §4 Canvas, §5 棋盘绘制 |
| 禁手检测 | 03-游戏规则 + 07-代码示例 | §3 禁手判定, 模板§3 |
| AI决策 | 03-AI算法 + 07-代码示例 | §4 AI体系, 模板§5 |
| 存档加载 | 10-细节补充 + 07-代码示例 | §3 数据格式, 模板§7 |
| VCF练习 | 03-游戏规则 + 10-细节补充 | §5 VCF逻辑, §3.3 题库结构 |
| 回放系统 | 10-细节补充 | §5 回放实现 |
| 模态框 | 10-细节补充 | §1 HTML结构 |
| 动画效果 | 10-细节补充 | §2 CSS动画 |

### 场景2: 解决问题

| 问题类型 | 查阅文档 |
|---------|---------|
| 模块加载失败 | 09-常见问题 Q1-Q2 |
| Canvas模糊/偏移 | 09-常见问题 Q3-Q4 |
| 禁手判定错误 | 09-常见问题 Q5-Q6 + 03-游戏规则 §3 |
| AI不响应 | 09-常见问题 Q7-Q8 |
| 存档加载失败 | 09-常见问题 Q9-Q10 |
| 部署404 | 09-常见问题 Q17-Q18 |

### 场景3: 遵循规范

| 需求 | 查阅文档 |
|------|---------|
| 命名约定 | 06-最佳实践 §1.1 |
| 错误处理 | 06-最佳实践 §2 |
| 性能优化 | 06-最佳实践 §3 |
| 代码复用 | 06-最佳实践 §4 |
| 模块导出 | 06-最佳实践 §1.3 + 07-代码示例 §1 |

---

## 🔍 关键数据结构速查

### 棋盘状态
```javascript
board[y][x]  // 注意：先y后x
// 0=空, 1=黑, 2=白
```

### 落子结果
```javascript
{
    success: true/false,
    error?: string,
    code?: string,
    gameOver?: boolean,
    winner?: number,
    winLine?: Array
}
```

### 存档JSON
见 `10-细节补充 §3.1`

### VCF题目
见 `10-细节补充 §3.3`

### 设置数据
见 `10-细节补充 §3.4`

---

## ⚠️ 关键注意事项

### 1. 模块加载顺序（重要！）
```html
<script src="js/utils.js"></script>          <!-- 1. 工具 -->
<script src="js/game-core.js"></script>      <!-- 2. 核心 -->
<script src="js/ai-advanced.js"></script>    <!-- 3. AI -->
<script src="js/board-renderer.js"></script> <!-- 4. 渲染 -->
<script src="js/game-save-load.js"></script> <!-- 5. 存档 -->
<script src="js/game-replay.js"></script>    <!-- 6. 回放 -->
<script src="js/vcf-practice.js"></script>   <!-- 7. VCF -->
<script src="js/demo.js"></script>           <!-- 8. UI（最后）-->
```

### 2. 坐标系统
- Canvas坐标: `(mouseX, mouseY)`
- 棋盘坐标: `(gridX, gridY)` 范围0-14
- 数组访问: `board[y][x]` - **先y后x！**

### 3. 禁手规则
- 仅对黑棋（player=1）有效
- 五连优先于禁手
- 必须临时落子检测，检测后恢复

### 4. AI思考状态
- 设置 `aiThinking=true` 锁定界面
- 完成后必须设置为 `false`
- 使用 `setTimeout` 延迟执行

### 5. VCF模式特殊处理
- 在 `board-renderer.placePiece()` 中单独判断
- 调用 `demo.handleVCFPracticeMove(x, y)`
- 禁用悔棋/存档/回放按钮

---

## 📋 开发检查清单

### 阶段0: 环境准备
- [ ] 创建项目目录结构
- [ ] 创建 index.html
- [ ] 创建 js/*.js 文件
- [ ] 创建 css/*.css 文件
- [ ] 验证浏览器打开无报错

### 阶段1: 核心功能
- [ ] GameUtils 模块导出成功
- [ ] GomokuGame 初始化15x15棋盘
- [ ] placePiece() 基本落子
- [ ] checkWin() 胜负判定
- [ ] SimpleBoardRenderer 渲染棋盘
- [ ] 鼠标点击可落子
- [ ] InterfaceDemo 初始化成功

### 阶段2: 规则完善
- [ ] checkForbidden() 三三禁手
- [ ] checkForbidden() 四四禁手
- [ ] checkForbidden() 长连禁手
- [ ] 禁手位置红色高亮
- [ ] undo() 悔棋功能

### 阶段3: AI系统
- [ ] getAIMove() 新手级别
- [ ] getAIMove() 正常级别
- [ ] getAIMove() 困难级别
- [ ] getAIMove() 地狱级别（含VCF）
- [ ] AI思考延迟与状态显示
- [ ] PvE/EvE模式切换

### 阶段4: 存档回放
- [ ] 保存为JSON文件
- [ ] 加载JSON文件
- [ ] 状态完整恢复
- [ ] 回放播放/暂停
- [ ] 回放速度调节
- [ ] 回放进度拖动

### 阶段5: VCF练习
- [ ] 40道题库加载
- [ ] 走法验证正确
- [ ] AI自动防守
- [ ] 进度保存到LocalStorage
- [ ] UI面板显示正常

### 阶段6: UX优化
- [ ] 提示系统（冷却3秒）
- [ ] 设置面板所有选项
- [ ] 帮助面板完整内容
- [ ] 动画效果
- [ ] 响应式布局

### 阶段7: 测试部署
- [ ] 所有浏览器兼容测试
- [ ] 性能指标达标
- [ ] 无控制台错误
- [ ] GitHub Pages部署成功

---

## 🚀 高效开发技巧

### 技巧1: 增量开发
不要一次性实现所有功能，按阶段验证：
```
实现 → 测试 → 验收 → 下一阶段
```

### 技巧2: 模板复用
直接从 `07_核心代码示例与模板.md` 复制代码骨架，填充业务逻辑。

### 技巧3: 日志调试
每个模块加载后输出日志：
```javascript
console.log('[ModuleName] 已加载，版本', __moduleInfo.version);
```

### 技巧4: 使用GameDebug
在浏览器Console中：
```javascript
GameDebug.board();           // 查看棋盘
GameDebug.forbidden(7, 7);   // 测试禁手
GameDebug.aiHint();          // 获取AI建议
```

### 技巧5: 分文件开发
先完成一个文件，测试通过后再开发下一个：
```
utils.js → game-core.js → board-renderer.js → demo.js
```

---

## 📚 文档交叉引用

当遇到术语或概念不清楚时，使用以下映射快速定位：

| 术语 | 定义文档 |
|------|---------|
| 活三 | 03-游戏规则 §3.2 |
| VCF | 03-游戏规则 §5, 10-细节补充 §3.3 |
| Minimax | 03-AI算法 §4.1 |
| Alpha-Beta | 03-AI算法 §4.2 |
| 候选点生成 | 03-AI算法 §4.3 |
| Canvas坐标转换 | 02-技术架构 §3.2, 04-UI设计 §5.2 |
| 模块导出模式 | 02-技术架构 §1.2, 06-最佳实践 §1.3 |
| 禁手临时落子 | 02-技术架构 §5.2 |
| 风险提示 | 10-细节补充 §4 |
| 回放状态机 | 10-细节补充 §5 |
| LocalStorage键名 | 10-细节补充 §9.1 |

---

## 🎓 最佳实践总结

1. **先读文档再写代码** - 避免走弯路
2. **严格按模块顺序开发** - 避免依赖问题
3. **每个模块立即测试** - 问题早发现早解决
4. **遵循命名约定** - 保持代码风格一致
5. **使用代码模板** - 提高开发效率
6. **参考原项目代码** - 但理解后再写，不盲目复制
7. **遇到问题先查FAQ** - 09文档覆盖常见问题
8. **保持日志输出** - 方便调试定位
9. **注释关键逻辑** - 特别是算法部分
10. **定期提交Git** - 每个阶段完成后提交

---

## 📊 预估工作量

| 阶段 | 工作量 | 难度 |
|------|--------|------|
| 阶段0 | 1小时 | ⭐ |
| 阶段1 | 6小时 | ⭐⭐ |
| 阶段2 | 4小时 | ⭐⭐⭐ |
| 阶段3 | 6小时 | ⭐⭐⭐⭐ |
| 阶段4 | 5小时 | ⭐⭐⭐ |
| 阶段5 | 5小时 | ⭐⭐⭐ |
| 阶段6 | 4小时 | ⭐⭐ |
| 阶段7 | 3小时 | ⭐⭐ |
| **总计** | **34小时** | - |

有经验的AI可压缩到20-25小时。

---

## ✅ 完成标准

当以下所有条件满足时，项目复刻完成：

- [ ] 所有11份迁移文档已阅读
- [ ] 7个开发阶段全部完成
- [ ] 功能测试100%通过
- [ ] 兼容性测试通过
- [ ] 性能指标达标
- [ ] 无控制台错误/警告
- [ ] 代码风格一致
- [ ] 可部署到GitHub Pages

---

## 🆘 遇到困难时

1. **先查FAQ** - `09_常见问题与解决方案.md`
2. **查细节补充** - `10_完整实现细节补充.md`
3. **重读相关章节** - 可能是理解有偏差
4. **检查模块顺序** - 很多问题是加载顺序导致
5. **查看浏览器Console** - 错误信息很有价值
6. **使用GameDebug** - 调试工具很有帮助

---

**祝开发顺利！** 🎉

如有任何疑问，请仔细对照文档中的代码示例和说明。这套文档已经过详细审查，足以支撑完整项目复刻。
